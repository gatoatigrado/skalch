#!/bin/bash
# not really, I just want to use formatting
# grshell script
new graph "SimpleLowering.grg"
import SugaredTest.scala.ast.gxl ScalaAstModel.gm
select actions lgsp-SimpleLoweringActions.dll



# node colors for printing
debug set layout Compilergraph
dump set node FcnDef color black
dump set node ClassDef color red
dump set node Symbol color blue
dump set edge BridgeFcn color green
dump set node MemberFcn color green



# functions requiring setEnclosing links
echo "adding info links"
xgrs setEnclosingFunctionInitial* & setEnclosingFunction*
echo "delete bridge functions"
xgrs deleteBridgeFunctions
# mostly my learning...
validate xgrs testNoBridgeFunctions
echo "convert $this to a parameter"
xgrs [transformFcnWrapper]
validate xgrs testNoThisNodes
echo "delete dangling nodes, and remove enclosing links"
xgrs deleteDangling*
xgrs removeEnclosingLinks*



# transformations not requiring EnclosingFcn links
xgrs replaceAssertCalls*



# final printing
xgrs deleteDangling*
show graph ycomp "--dolayout"
